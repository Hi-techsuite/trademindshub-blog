on:
  push:
      branches:
          -   deploy
name: ðŸš€ Deploy App on Push
jobs:
web-deploy:
  name: ðŸŽ‰ Deploy
  runs-on: ubuntu-latest
  steps:
  - name: ðŸšš Get latest code
    uses: actions/checkout@v3

  - name: Use Node.js 16
    uses: actions/setup-node@v2
    with:
      node-version: '16'
    
  - name: ðŸ”¨ Installing Node Modules Project
    run:  npm ci
  
  # - name: Building project
  #   run: npm run build --if-present
  #   env:
  #     CI: false
  - name: ðŸ“‚ Sync files
    uses: SamKirkland/FTP-Deploy-Action@v4.3.4
    with:
      server: ${{secrets.server}}
      username: ${{secrets.username}}
      password: ${{secrets.password }}
      server-dir: /trade-blog.vitalskillsda.com/

  - name: "Setup Environmental variables and Migration Now"
    run:  |
      touch .env
      # echo APP_PORT=${{secrets.APP_PORT}} >> .env
      # echo DB_PORT=${{secrets.DB_PORT}} >> .env
      # echo NODE_ENV=${{secrets.NODE_ENV}} >> .env
      echo DEV_USERNAME=${{secrets.DEV_USERNAME}} >> .env
      echo DEV_PASSWORD=${{secrets.DEV_PASSWORD}} >> .env
      # echo DEV_HOST=${{secrets.DEV_HOST}} >> .env
      # echo DEV_DIALECT=${{secrets.DEV_DIALECT}} >> .env
      # npx sequelize-cli db:migrate
   
      
